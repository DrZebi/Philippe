ki = min(ki + 100, ki_max);